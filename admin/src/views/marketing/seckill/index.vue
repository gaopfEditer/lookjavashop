<template>    <div class="seckill-lists">        <el-card class="!border-none" shadow="never">            <el-alert                type="warning"                title="温馨提示：1.新增秒杀时可选统一规格或者多规格，满足秒杀不同销售属性场景；2.秒杀销售状态分为销售中且库存足够时才可下单购买。"                :closable="false"                show-icon            />            <el-form ref="formRef" class="mb-[-16px] mt-[16px]" :model="queryParams" :inline="true">                <el-form-item label="活动名称">                    <el-input                        class="w-[280px]"                        v-model="queryParams.name"                        placeholder="请输入活动名称"                        :clearable="true"                        @keyup.enter="resetPage"                    />                </el-form-item>                <el-form-item label="商品名称">                    <el-input                        class="w-[280px]"                        v-model="queryParams.goodsName"                        placeholder="请输入名称"                        :clearable="true"                        @keyup.enter="resetPage"                    />                </el-form-item>                <el-form-item label="活动时间">                    <daterange-picker                        value-format="x"                        :second="true"                        v-model:startTime="queryParams.startTime"                        v-model:endTime="queryParams.endTime"                    />                </el-form-item>                <el-form-item>                    <el-button type="primary" @click="resetPage">查询</el-button>                    <el-button @click="resetParams">重置</el-button>                </el-form-item>            </el-form>        </el-card>        <el-card class="!border-none mt-4" :body-style="{ 'padding-top': '10px' }" shadow="never">            <!-- 选项卡 -->            <el-tabs v-model="queryParams.type" @tab-change="changeTabs">                <template v-for="(tabItem, tabIndex) in tabsParams.TabsEnumMap" :key="tabIndex">                    <el-tab-pane                        :label="`${tabItem.label}(${pager.extend[tabItem.type] || 0})`"                        :name="tabItem.name"                    />                </template>            </el-tabs>            <el-button type="primary">                <router-link                    :to="{                        path: getRoutePath('marketing:seckill:detail')                    }"                >                    + 新增秒杀                </router-link>            </el-button>            <!-- 表格 -->            <el-table size="large" class="mt-4" v-loading="pager.loading" :data="pager.lists">                <el-table-column                    label="活动名称"                    prop="name"                    min-width="140"                    :show-overflow-tooltip="true"                />                <el-table-column label="活动时间" min-width="180">                    <template #default="{ row }">                        <div>{{ row.startTime }}</div>                        <div>{{ row.endTime }}</div>                    </template>                </el-table-column>                <el-table-column label="商品数量" prop="goodsNum" min-width="120" />                <el-table-column label="秒杀订单" prop="closingOrder" min-width="120" />                <el-table-column label="秒杀销售额" prop="salesAmount" min-width="120" />                <el-table-column label="秒杀销售量" prop="salesVolume" min-width="120" />                <el-table-column label="活动状态" min-width="120">                    <template #default="{ row }">                        <el-tag v-if="row?.status == 1" type="warning">待发布</el-tag>                        <el-tag v-if="row?.status == 2" type="danger">未开始</el-tag>                        <el-tag v-if="row?.status == 3" type="success">进行中</el-tag>                        <el-tag v-if="row?.status == 4" type="info" >已结束</el-tag>                    </template>                </el-table-column>                <el-table-column label="创建时间" prop="createTime" min-width="180" />                <el-table-column label="操作" width="220" fixed="right">                    <template #default="{ row }">                        <el-button v-perms="['marketing:seckill:detail']" type="primary" :link="true">                            <router-link                                :to="{                                    path: getRoutePath('marketing:seckill:detail'),                                    query: {                                        id: row.id,                                        read_only: 1                                    }                                }"                            >                                详情                            </router-link>                        </el-button>                        <el-button                            v-if="row.status != 4"                            v-perms="['marketing:seckill:edit']"                            type="primary"                            :link="true"                        >                            <router-link                                :to="{                                    path: getRoutePath('marketing:seckill:detail'),                                    query: {                                        id: row.id                                    }                                }"                            >                                编辑                            </router-link>                        </el-button>                        <el-button                            v-if="row.status == 1"                            v-perms="['marketing:seckill:release']"                            type="primary"                            :link="true"                            @click="handleRelease(row.id, row.name)"                        >                            发布                        </el-button>                        <el-button                            v-if="row.status == 2"                            v-perms="['marketing:seckill:start']"                            type="primary"                            :link="true"                            @click="handleStart(row.id, row.name)"                        >                            开始                        </el-button>                        <el-button                            v-if="row.status == 3"                            v-perms="['marketing:seckill:end']"                            type="primary"                            :link="true"                            @click="handleEnd(row.id, row.name)"                        >                            结束                        </el-button>                        <el-button                            v-perms="['marketing:seckill:del']"                            type="danger"                            :link="true"                            @click="handleDelete(row.id, row.name)"                        >                            删除                        </el-button>                    </template>                </el-table-column>            </el-table>            <div class="flex justify-end mt-4">                <pagination v-model="pager" @change="getLists" />            </div>        </el-card>    </div></template><script lang="ts" setup name="SeckillLists">import { usePaging } from '@/hooks/usePaging'import { getRoutePath } from '@/router'import { seckillLists, seckillRelease, seckillStart, seckillEnd, seckillDel } from '@/api/marketing/seckill'import type { SeckillListQueryParamsType } from "@/api/marketing/seckill.d"import feedback from '@/utils/feedback'// Tab类型enum TabsEnum {    ALL = 'all',    WAIT = 'wait',    NOT = 'not',    CONDUCT = 'conduct',    END = 'end'}const tabsParams = reactive({    TabsEnumMap: [        {            label: '全部',            name: '',            type: TabsEnum.ALL        },        {            label: '待发布',            name: '1',            type: TabsEnum.WAIT        },        {            label: '未开始',            name: '2',            type: TabsEnum.NOT        },        {            label: '进行中',            name: '3',            type: TabsEnum.CONDUCT        },        {            label: '已结束',            name: '4',            type: TabsEnum.END        }    ]})const queryParams = reactive<SeckillListQueryParamsType>({    name: '',    goodsName: '',    startTime: '',    endTime: '',    type: ''})const { pager, getLists, resetPage, resetParams } = usePaging({    fetchFun: seckillLists,    params: queryParams})const changeTabs = (name: string) => {    queryParams.type = name    getLists()}const handleRelease = async (id: number, name: string) => {    try {        await feedback.confirm(`确定发布(${name})活动吗？`)        await seckillRelease({ id })        getLists()    } catch (error) {        console.log('发布秒杀失败=>', error)    }}const handleStart = async (id: number, name: string) => {    try {        await feedback.confirm(`确定开启(${name})活动吗？`)        await seckillStart({ id })        getLists()    } catch (error) {        console.log('开启秒杀失败=>', error)    }}const handleEnd = async (id: number, name: string) => {    try {        await feedback.confirm(`确定结束(${name})活动吗？`)        await seckillEnd({ id })        getLists()    } catch (error) {        console.log('结束秒杀失败=>', error)    }}const handleDelete = async (id: number, name: string) => {    try {        await feedback.confirm(`确定删除(${name})活动吗？`)        await seckillDel({ id })        getLists()    } catch (error) {        console.log('删除秒杀失败=>', error)    }}onActivated(() => {    getLists()})onMounted(() => {    getLists()})</script>